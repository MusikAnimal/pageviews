%div#ad_blocker_notice(style="display:none")
  %h3 Looks like you are using an ad blocker!
  %br
  Pageviews Analysis shows no ads, but the ad blockers blacklist websites that collect metrics.
  In our case, we're just trying to show you metrics, not collect them!

  %h2
    Please whitelist
    %code
      tools.wmflabs.org

  %h4 AdBlock Plus
  %p
    Click on the AdBlock Plus icon and select <i>Disable on tools.wmflabs.org</i>. Reload the page.
  %h4 uBlock
  %p
    Click on the uBlock icon and then click on the large power icon. Reload the page.

%div#cookie_disabled_notice.col-lg-10.text-center(style="display:none")
  %h3 Looks like you have cookies disabled!
  %br
  %p
    Pageviews Analysis uses an internationalization library that requires to cookies to function.
    %br
    Only your language preference is stored in a cookie. No sensitive information is recorded.
  %br
  %p
    %strong Please enable cookies or whitelist <code>tools.wmflabs.org</code> if you are using a cookie blocker.

%footer.col-lg-10
  %span
    - $MusikAnimal = "<a href='https://en.wikipedia.org/wiki/User:MusikAnimal'>MusikAnimal</a>";
    - $Kaldari = "<a href='https://en.wikipedia.org/wiki/User:Kaldari'>Kaldari</a>";
    - $MarcelRuizForns = "<a href='https://en.wikipedia.org/wiki/User:Mforns_(WMF)'>Marcel Ruiz Forns</a>";
    = $I18N->msg( 'credits', array( 'variables' => array( $MusikAnimal, $Kaldari, $MarcelRuizForns ) ) );

  %span.nowrap
    - $heart = "<span class='heart'>&hearts;</span>";
    - $host = "<a href='https://wikitech.wikimedia.org/wiki/Portal:Tool_Labs'>" . $I18N->msg( 'tool-labs' ) . "</a>";
    = $I18N->msg( 'hosted', array( 'variables' => array( $heart, $host ) ) );

  %div
    %a(href="/#{$app}/faq")
      = $I18N->msg( 'faq' )
    &middot;
    %a(href="#" data-toggle="modal" data-target="#disclaimer-modal")
      = $I18N->msg( 'disclaimer' )
    &middot;
    %a(href="/#{$app}/url_structure")
      = $I18N->msg( 'url-structure' )
    &middot;
    %a(href="https://github.com/MusikAnimal/pageviews")
      = $I18N->msg( 'view-source' )
    &middot;
    %a(href="https://github.com/MusikAnimal/pageviews/issues")
      = $I18N->msg( 'report-issue' )

%div#disclaimer-modal.modal.fade(role="dialog" tabindex="-1")
  %div.modal-dialog(role="document")
    %div.modal-content
      %div.modal-header
        %button.close(arialabel="Close" data-dismiss="modal" type="button")
          %span(ariahidden="true") &times;
        %h4.modal-title
          = $I18N->msg( 'disclaimer' )

      %div.modal-body
        - $api = "<a href='https://wikimedia.org/api/rest_v1/?doc#/'>" . $I18N->msg( 'rest-api' ) . "</a>";
        - $maintainer = "maintainers";
        = $I18N->msg( 'disclaimer-text', array( 'variables' => array( $api, $maintainer ) ) );

      %div.modal-footer
        %button.btn.btn-primary(data-dismiss="modal" type="button")
          = $I18N->msg( 'ok' )

:javascript
  if(!window.noAdBlockers) {
    var noticeContent = document.getElementById('ad_blocker_notice');
    document.querySelector('body').innerHTML = noticeContent.innerHTML;
  }

  var cookieEnabled = navigator.cookieEnabled ? true : false;
  if (typeof navigator.cookieEnabled === "undefined" && !cookieEnabled) {
      document.cookie = "testcookie";
      cookieEnabled = (document.cookie.indexOf("testcookie") !== -1) ? true : false;
  }

  if (!cookieEnabled) {
    document.querySelector('main').style.display = 'none';
    document.getElementById('cookie_disabled_notice').style.display = 'block';
  }
